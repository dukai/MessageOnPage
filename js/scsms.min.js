!function(){var a={},b=function(b,d){var f=document.getElementsByTagName("script"),g=f[f.length-1],h=e(g),i=document.createElement("a");i.href=h;var j=i.pathname;2==arguments.length?b=j.replace(/[^\/]+\.js/,"")+b:(d=b,b=j.replace(".js",""));var k={exports:{}},l=k.exports;d(c,l,k),a[b]=k.exports},c=function(b){if("."==b.charAt(0)){var c=document.getElementsByTagName("script"),f=c[c.length-1],g=e(f);""==g&&(g=window.location.href);var h=d(g).pathname,i=b.split("/"),j=h.split("/");for(j.pop();"."==i[0]||".."==i[0];){var k=i.shift();"."==k||".."==k&&j.pop()}var l=j.concat(i);b=l.join("/")}return a[b]},d=function(a){var b=document.createElement("a");return b.href=a,{pathname:b.pathname,host:b.host}},e=function(a){return a.hasAttribute?a.src:a.getAttribute("src",4)},f=function(a){a(c)};window.define=b,window.use=f}(),define("msgtool",function(a,b,c){var d={faces:[["强","[/qiang]","qiang.gif"],["弱","[/ruo]","ruo.gif"],["握手","[/ws]","ws.gif"],["胜利","[/shl]","shl.gif"],["抱拳","[/bq]","bq.gif"],["勾引","[/gy]","gy.gif"],["拳头","[/qt]","qt.gif"],["差劲","[/cj]","cj.gif"],["爱你","[/aini]","aini.gif"],["NO","[/bu]","bu.gif"],["YES","[/hd]","hd.gif"],["微笑","[/wx]","wx.gif"],["撇嘴","[/pz]","pz.gif"],["色","[/se]","se.gif"],["发呆","[/fd]","fd.gif"],["得意","[/dy]","dy.gif"],["流泪","[/ll]","ll.gif"],["害羞","[/hx]","hx.gif"],["闭嘴","[/bz]","bz.gif"],["睡","[/shui]","shui.gif"],["大哭","[/dk]","dk.gif"],["尴尬","[/gg]","gg.gif"],["发怒","[/fn]","fn.gif"],["调皮","[/tp]","tp.gif"],["呲牙","[/cy]","cy.gif"],["惊讶","[/jy]","jy.gif"],["难过","[/ng]","ng.gif"],["酷酷","[/kuk]","kuk.gif"],["冷汗","[/lengh]","lengh.gif"],["抓狂","[/zk]","zk.gif"],["吐","[/tuu]","tuu.gif"],["偷笑","[/tx]","tx.gif"],["可爱","[/ka]","ka.gif"],["白眼","[/baiy]","baiy.gif"],["傲慢","[/am]","am.gif"],["饥饿","[/jie]","jie.gif"],["困","[/kun]","kun.gif"],["惊恐","[/jk]","jk.gif"],["流汗","[/lh]","lh.gif"],["憨笑","[/hanx]","hanx.gif"],["大兵","[/db]","db.gif"],["奋斗","[/fendou]","fendou.gif"],["咒骂","[/zhm]","zhm.gif"],["疑问","[/yiw]","yiw.gif"],["嘘","[/xu]","xu.gif"],["晕","[/yun]","yun.gif"],["折磨","[/zhem]","zhem.gif"],["衰","[/shuai]","shuai.gif"],["骷髅","[/kl]","kl.gif"],["敲","[/qiao]","qiao.gif"],["再见","[/zj]","zj.gif"],["擦汗","[/ch]","ch.gif"],["抠鼻","[/kb]","kb.gif"],["鼓掌","[/gz]","gz.gif"],["糗大了","[/qd]","qd.gif"],["坏笑","[/huaix]","huaix.gif"],["左哼哼","[/zhh]","zhh.gif"],["右哼哼","[/yhh]","yhh.gif"],["哈欠","[/hq]","hq.gif"],["鄙视","[/bs]","bs.gif"],["委屈","[/wq]","wq.gif"],["快哭了","[/kk]","kk.gif"],["阴险","[/yx]","yx.gif"],["亲亲","[/qq]","qq.gif"],["吓","[/xia]","xia.gif"],["可怜","[/kel]","kel.gif"],["菜刀","[/cd]","cd.gif"],["刀","[/dao]","dao.gif"],["玫瑰","[/mg]","mg.gif"],["凋谢","[/dx]","dx.gif"],["西瓜","[/xig]","xig.gif"],["啤酒","[/pj]","pj.gif"],["蛋糕","[/dg]","dg.gif"],["咖啡","[/kf]","kf.gif"],["饭","[/fan]","fan.gif"],["示爱","[/sa]","sa.gif"],["心","[/xin]","xin.gif"],["心碎","[/xs]","xs.gif"],["闪电","[/shd]","shd.gif"],["炸弹","[/zhd]","zhd.gif"],["猪头","[/zt]","zt.gif"],["瓢虫","[/pch]","pch.gif"],["便便","[/bb]","bb.gif"],["太阳","[/ty]","ty.gif"],["月亮","[/yl]","yl.gif"],["礼物","[/lw]","lw.gif"],["拥抱","[/yb]","yb.gif"],["足球","[/zq]","zq.gif"],["篮球","[/lq]","lq.gif"],["乒乓","[/pp]","pp.gif"]],showFace:function(a){var b=this.faces;if("string"==typeof a){for(var c=0;c<b.length;c++)a=a.replace(/((\[)[^\s]+?(\]))/g,function(a){return a==b[c][1]?'<img width="24" height="24" src="http://img.scimg.cn/expression/default/'+b[c][2]+'" alt="'+b[c][0]+'" title="'+b[c][0]+'" />':a});return a}},showBold:function(a){return"string"==typeof a?a=a.replace(/\[[b]\]/gi,"<b>").replace(/\[\/[b]\]/gi,"</b>").replace(/\[[i]\]/gi,"<i>").replace(/\[\/[i]\]/gi,"</i>").replace(/\[color=(\w+)\]/gi,"<font color='$1'>").replace(/\[\/color\]/gi,"</font>").replace(/\[img\]([\s\S]*?)\[\/img\]/gi,"<img src='$1' />").replace(/\[url=([\s\S]*?)\]\[\/url\]/gi,"$1").replace(/\[url\]([\s\S]*?)\[\/url\]/gi,"$1").replace(/\[url=([\s\S]*?)\]([\s\S]*?)\[\/url\]/gi,"$2"):void 0},showBoldAndUrl:function(a){return"string"==typeof a?a=a.replace(/\[[b]\]/gi,"<b>").replace(/\[\/[b]\]/gi,"</b>").replace(/\[[i]\]/gi,"<i>").replace(/\[\/[i]\]/gi,"</i>").replace(/\[color=(\w+)\]/gi,"<font color='$1'>").replace(/\[\/color\]/gi,"</font>").replace(/\[img\]([\s\S]*?)\[\/img\]/gi,"<img src='$1' />").replace(/\[url=([\s\S]*?)\]\[\/url\]/gi,"<a href='$1' target='_blank'>$1</a>").replace(/\[url\]([\s\S]*?)\[\/url\]/gi,"<a href='$1' target='_blank'>$1</a>").replace(/\[url=([\s\S]*?)\]([\s\S]*?)\[\/url\]/gi,"<a href='$1' target='_blank'>$2</a>"):void 0}};c.exports=d}),define("swfobject",function(a,b,c){c.exports=function(){function a(){if(!R){try{var a=K.getElementsByTagName("body")[0].appendChild(q("span"));a.parentNode.removeChild(a)}catch(b){return}R=!0;for(var c=N.length,d=0;c>d;d++)N[d]()}}function b(a){R?a():N[N.length]=a}function c(a){if(typeof J.addEventListener!=C)J.addEventListener("load",a,!1);else if(typeof K.addEventListener!=C)K.addEventListener("load",a,!1);else if(typeof J.attachEvent!=C)r(J,"onload",a);else if("function"==typeof J.onload){var b=J.onload;J.onload=function(){b(),a()}}else J.onload=a}function d(){M?e():f()}function e(){var a=K.getElementsByTagName("body")[0],b=q(D);b.setAttribute("type",G);var c=a.appendChild(b);if(c){var d=0;!function(){if(typeof c.GetVariable!=C){var e=c.GetVariable("$version");e&&(e=e.split(" ")[1].split(","),U.pv=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10)])}else if(10>d)return d++,void setTimeout(arguments.callee,10);a.removeChild(b),c=null,f()}()}else f()}function f(){var a=O.length;if(a>0)for(var b=0;a>b;b++){var c=O[b].id,d=O[b].callbackFn,e={success:!1,id:c};if(U.pv[0]>0){var f=p(c);if(f)if(!s(O[b].swfVersion)||U.wk&&U.wk<312)if(O[b].expressInstall&&h()){var k={};k.data=O[b].expressInstall,k.width=f.getAttribute("width")||"0",k.height=f.getAttribute("height")||"0",f.getAttribute("class")&&(k.styleclass=f.getAttribute("class")),f.getAttribute("align")&&(k.align=f.getAttribute("align"));for(var l={},m=f.getElementsByTagName("param"),n=m.length,o=0;n>o;o++)"movie"!=m[o].getAttribute("name").toLowerCase()&&(l[m[o].getAttribute("name")]=m[o].getAttribute("value"));i(k,l,c,d)}else j(f),d&&d(e);else u(c,!0),d&&(e.success=!0,e.ref=g(c),d(e))}else if(u(c,!0),d){var q=g(c);q&&typeof q.SetVariable!=C&&(e.success=!0,e.ref=q),d(e)}}}function g(a){var b=null,c=p(a);if(c&&"OBJECT"==c.nodeName)if(typeof c.SetVariable!=C)b=c;else{var d=c.getElementsByTagName(D)[0];d&&(b=d)}return b}function h(){return!S&&s("6.0.65")&&(U.win||U.mac)&&!(U.wk&&U.wk<312)}function i(a,b,c,d){S=!0,y=d||null,z={success:!1,id:c};var e=p(c);if(e){"OBJECT"==e.nodeName?(w=k(e),x=null):(w=e,x=c),a.id=H,(typeof a.width==C||!/%$/.test(a.width)&&parseInt(a.width,10)<310)&&(a.width="310"),(typeof a.height==C||!/%$/.test(a.height)&&parseInt(a.height,10)<137)&&(a.height="137"),K.title=K.title.slice(0,47)+" - Flash Player Installation";var f=U.ie&&U.win?"ActiveX":"PlugIn",g="MMredirectURL="+J.location.toString().replace(/&/g,"%26")+"&MMplayerType="+f+"&MMdoctitle="+K.title;if(typeof b.flashvars!=C?b.flashvars+="&"+g:b.flashvars=g,U.ie&&U.win&&4!=e.readyState){var h=q("div");c+="SWFObjectNew",h.setAttribute("id",c),e.parentNode.insertBefore(h,e),e.style.display="none",function(){4==e.readyState?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}l(a,b,c)}}function j(a){if(U.ie&&U.win&&4!=a.readyState){var b=q("div");a.parentNode.insertBefore(b,a),b.parentNode.replaceChild(k(a),b),a.style.display="none",function(){4==a.readyState?a.parentNode.removeChild(a):setTimeout(arguments.callee,10)}()}else a.parentNode.replaceChild(k(a),a)}function k(a){var b=q("div");if(U.win&&U.ie)b.innerHTML=a.innerHTML;else{var c=a.getElementsByTagName(D)[0];if(c){var d=c.childNodes;if(d)for(var e=d.length,f=0;e>f;f++)1==d[f].nodeType&&"PARAM"==d[f].nodeName||8==d[f].nodeType||b.appendChild(d[f].cloneNode(!0))}}return b}function l(a,b,c){var d,e=p(c);if(U.wk&&U.wk<312)return d;if(e)if(typeof a.id==C&&(a.id=c),U.ie&&U.win){var f="";for(var g in a)a[g]!=Object.prototype[g]&&("data"==g.toLowerCase()?b.movie=a[g]:"styleclass"==g.toLowerCase()?f+=' class="'+a[g]+'"':"classid"!=g.toLowerCase()&&(f+=" "+g+'="'+a[g]+'"'));var h="";for(var i in b)b[i]!=Object.prototype[i]&&(h+='<param name="'+i+'" value="'+b[i]+'" />');e.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+f+">"+h+"</object>",P[P.length]=a.id,d=p(a.id)}else{var j=q(D);j.setAttribute("type",G);for(var k in a)a[k]!=Object.prototype[k]&&("styleclass"==k.toLowerCase()?j.setAttribute("class",a[k]):"classid"!=k.toLowerCase()&&j.setAttribute(k,a[k]));for(var l in b)b[l]!=Object.prototype[l]&&"movie"!=l.toLowerCase()&&m(j,l,b[l]);e.parentNode.replaceChild(j,e),d=j}return d}function m(a,b,c){var d=q("param");d.setAttribute("name",b),d.setAttribute("value",c),a.appendChild(d)}function n(a){var b=p(a);b&&"OBJECT"==b.nodeName&&(U.ie&&U.win?(b.style.display="none",function(){4==b.readyState?o(a):setTimeout(arguments.callee,10)}()):b.parentNode.removeChild(b))}function o(a){var b=p(a);if(b){for(var c in b)"function"==typeof b[c]&&(b[c]=null);b.parentNode.removeChild(b)}}function p(a){var b=null;try{b=K.getElementById(a)}catch(c){}return b}function q(a){return K.createElement(a)}function r(a,b,c){a.attachEvent(b,c),Q[Q.length]=[a,b,c]}function s(a){var b=U.pv,c=a.split(".");return c[0]=parseInt(c[0],10),c[1]=parseInt(c[1],10)||0,c[2]=parseInt(c[2],10)||0,b[0]>c[0]||b[0]==c[0]&&b[1]>c[1]||b[0]==c[0]&&b[1]==c[1]&&b[2]>=c[2]?!0:!1}function t(a,b,c,d){if(!U.ie||!U.mac){var e=K.getElementsByTagName("head")[0];if(e){var f=c&&"string"==typeof c?c:"screen";if(d&&(A=null,B=null),!A||B!=f){var g=q("style");g.setAttribute("type","text/css"),g.setAttribute("media",f),A=e.appendChild(g),U.ie&&U.win&&typeof K.styleSheets!=C&&K.styleSheets.length>0&&(A=K.styleSheets[K.styleSheets.length-1]),B=f}U.ie&&U.win?A&&typeof A.addRule==D&&A.addRule(a,b):A&&typeof K.createTextNode!=C&&A.appendChild(K.createTextNode(a+" {"+b+"}"))}}}function u(a,b){if(T){var c=b?"visible":"hidden";R&&p(a)?p(a).style.visibility=c:t("#"+a,"visibility:"+c)}}function v(a){var b=/[\\\"<>\.;]/,c=null!=b.exec(a);return c&&typeof encodeURIComponent!=C?encodeURIComponent(a):a}{var w,x,y,z,A,B,C="undefined",D="object",E="Shockwave Flash",F="ShockwaveFlash.ShockwaveFlash",G="application/x-shockwave-flash",H="SWFObjectExprInst",I="onreadystatechange",J=window,K=document,L=navigator,M=!1,N=[d],O=[],P=[],Q=[],R=!1,S=!1,T=!0,U=function(){var a=typeof K.getElementById!=C&&typeof K.getElementsByTagName!=C&&typeof K.createElement!=C,b=L.userAgent.toLowerCase(),c=L.platform.toLowerCase(),d=/win/.test(c?c:b),e=/mac/.test(c?c:b),f=/webkit/.test(b)?parseFloat(b.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,g=!1,h=[0,0,0],i=null;if(typeof L.plugins!=C&&typeof L.plugins[E]==D)i=L.plugins[E].description,!i||typeof L.mimeTypes!=C&&L.mimeTypes[G]&&!L.mimeTypes[G].enabledPlugin||(M=!0,g=!1,i=i.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),h[0]=parseInt(i.replace(/^(.*)\..*$/,"$1"),10),h[1]=parseInt(i.replace(/^.*\.(.*)\s.*$/,"$1"),10),h[2]=/[a-zA-Z]/.test(i)?parseInt(i.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof J.ActiveXObject!=C)try{var j=new ActiveXObject(F);j&&(i=j.GetVariable("$version"),i&&(g=!0,i=i.split(" ")[1].split(","),h=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)]))}catch(k){}return{w3:a,pv:h,wk:f,ie:g,win:d,mac:e}}();!function(){U.w3&&((typeof K.readyState!=C&&"complete"==K.readyState||typeof K.readyState==C&&(K.getElementsByTagName("body")[0]||K.body))&&a(),R||(typeof K.addEventListener!=C&&K.addEventListener("DOMContentLoaded",a,!1),U.ie&&U.win&&(K.attachEvent(I,function(){"complete"==K.readyState&&(K.detachEvent(I,arguments.callee),a())}),J==top&&!function(){if(!R){try{K.documentElement.doScroll("left")}catch(b){return void setTimeout(arguments.callee,0)}a()}}()),U.wk&&!function(){return R?void 0:/loaded|complete/.test(K.readyState)?void a():void setTimeout(arguments.callee,0)}(),c(a)))}(),function(){U.ie&&U.win&&window.attachEvent("onunload",function(){for(var a=Q.length,b=0;a>b;b++)Q[b][0].detachEvent(Q[b][1],Q[b][2]);for(var c=P.length,d=0;c>d;d++)n(P[d]);for(var e in U)U[e]=null;U=null;for(var f in swfobject)swfobject[f]=null;swfobject=null})}()}return{registerObject:function(a,b,c,d){if(U.w3&&a&&b){var e={};e.id=a,e.swfVersion=b,e.expressInstall=c,e.callbackFn=d,O[O.length]=e,u(a,!1)}else d&&d({success:!1,id:a})},getObjectById:function(a){return U.w3?g(a):void 0},embedSWF:function(a,c,d,e,f,g,j,k,m,n){var o={success:!1,id:c};U.w3&&!(U.wk&&U.wk<312)&&a&&c&&d&&e&&f?(u(c,!1),b(function(){d+="",e+="";var b={};if(m&&typeof m===D)for(var p in m)b[p]=m[p];b.data=a,b.width=d,b.height=e;var q={};if(k&&typeof k===D)for(var r in k)q[r]=k[r];if(j&&typeof j===D)for(var t in j)typeof q.flashvars!=C?q.flashvars+="&"+t+"="+j[t]:q.flashvars=t+"="+j[t];if(s(f)){var v=l(b,q,c);b.id==c&&u(c,!0),o.success=!0,o.ref=v}else{if(g&&h())return b.data=g,void i(b,q,c,n);u(c,!0)}n&&n(o)})):n&&n(o)},switchOffAutoHideShow:function(){T=!1},ua:U,getFlashPlayerVersion:function(){return{major:U.pv[0],minor:U.pv[1],release:U.pv[2]}},hasFlashPlayerVersion:s,createSWF:function(a,b,c){return U.w3?l(a,b,c):void 0},showExpressInstall:function(a,b,c,d){U.w3&&h()&&i(a,b,c,d)},removeSWF:function(a){U.w3&&n(a)},createCSS:function(a,b,c,d){U.w3&&t(a,b,c,d)},addDomLoadEvent:b,addLoadEvent:c,getQueryParamValue:function(a){var b=K.location.search||K.location.hash;if(b){if(/\?/.test(b)&&(b=b.split("?")[1]),null==a)return v(b);for(var c=b.split("&"),d=0;d<c.length;d++)if(c[d].substring(0,c[d].indexOf("="))==a)return v(c[d].substring(c[d].indexOf("=")+1))}return""},expressInstallCallback:function(){if(S){var a=p(H);a&&w&&(a.parentNode.replaceChild(w,a),x&&(u(x,!0),U.ie&&U.win&&(w.style.display="block")),y&&y(z)),S=!1}}}}(),window.swfobject=c.exports});var isPlainObject=function(a){return a.hasOwnProperty("constructor")||"object"!=typeof a||a.constructor!=Object?!1:!0},mix=function(a,b,c){var d=new Object;for(var e in a)d[e]=a[e];for(var e in b)d[e]=c&&isPlainObject(d[e])?mix(d[e],b[e]):b[e];return d},extend=function(a,b){var c=a.parent={__construct:function(a,c){b.apply(a,c)}};for(var d in b.prototype)c[d]=b.prototype[d],d in a.prototype||(a.prototype[d]=b.prototype[d])},trim=function(a,b){var c;return c=b?new RegExp("^("+b+")+|("+b+")+$","g"):/^(\s|\u00A0)+|(\s|\u00A0)+$/g,a.replace(c,"")},dashToUnderScore=function(a){return a.replace(/-/g,"_")},dashToCamel=function(a){return a.replace(/-([a-z])/,function(a){return a[1].toUpperCase()})},camel2Dash=function(a){return a.replace(/.+([A-Z])/,function(a){return"-"+a[1].toLowerCase()})},indexOf=function(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1},eles={div:document.createElement("div"),ul:document.createElement("ul"),li:document.createElement("li"),span:document.createElement("span"),p:document.createElement("p"),a:document.createElement("a"),fragment:document.createDocumentFragment(),input:document.createElement("input")},$c=function(a,b,c){var d=null;return eles[a]?d=eles[a].cloneNode(!0):(eles[a]=document.createElement(a),d=eles[a].cloneNode(!0)),b&&(d.id=b),c&&(d.className=c),d},rand=function(a,b){return Math.floor((b-a+1)*Math.random()+a)},EventEmitter=function(){this._initEventEmitter()};EventEmitter.prototype={_initEventEmitter:function(){this._events={}},emit:function(a,b){if(this._events[a])for(var c=this._events[a].slice(),d=0,e=c.length;e>d;d++)c[d].listener.call(this,b)},addListener:function(a,b){this._events[a]||(this._events[a]=[]),this._events[a].push({type:a,listener:b})},on:function(a,b){this.addListener(a,b)},once:function(a,b){function c(e){this.removeListener(a,c),d||(d=!0,b.apply(this,e))}var d=!1;c.listener=b,this.on(a,c)},removeListener:function(a,b){for(var c=this._events[a],d=0,e=c.length;e>d;d++)c[d]==b&&this._events[a].splice(d,1)},removeAllListeners:function(a){void 0==a?this._events={}:delete this._events[a]}};var Template=function(a){var b="<?";a=a.replace(/('|"|\\)/g,"\\$1").replace(/\r/g,"").replace(/\t/g,"\\t").replace(/\n/g,"\\n"),a=a.split(b).join("	").replace(/\t=(.*?)\?>/g,function(){var a=arguments[1].replace(/\\t/g," ").replace(/\\n/g,"\n").replace(/\\r/,"\r").replace(/\\('|"|\\)/g,"$1");return"' + "+a+";\r\n___tpContent += '"}).replace(/\t(.*?)\?>/g,function(){var a=arguments[1].replace(/\\t/g," ").replace(/\\n/g,"\n").replace(/\\r/,"\r").replace(/\\('|"|\\)/g,"$1");return"';\r\n"+a+"\r\n___tpContent += '"});var c="var ___tpContent = '',	print = function(){		___tpContent += [].join.call(arguments, '');	};	___tpContent += '"+a+"';	return ___tpContent;";this.render=function(a){return new Function(c).call(a)}};define("template",function(a,b,c){var d=function(a){var b="<?";a=a.replace(/('|"|\\)/g,"\\$1").replace(/\r/g,"").replace(/\t/g,"\\t").replace(/\n/g,"\\n"),a=a.split(b).join("	").replace(/\t=(.*?)\?>/g,function(){var a=arguments[1].replace(/\\t/g," ").replace(/\\n/g,"\n").replace(/\\r/,"\r").replace(/\\('|"|\\)/g,"$1");return"' + "+a+";\r\n___tpContent += '"}).replace(/\t(.*?)\?>/g,function(){var a=arguments[1].replace(/\\t/g," ").replace(/\\n/g,"\n").replace(/\\r/,"\r").replace(/\\('|"|\\)/g,"$1");return"';\r\n"+a+"\r\n___tpContent += '"});var c="var ___tpContent = '',		print = function(){			___tpContent += [].join.call(arguments, '');		};		___tpContent += '"+a+"';		return ___tpContent;";this.render=function(a){return new Function(c).call(a)}};c.exports=d}),define("messagebar",function(a,b,c){var d=a("./template"),e=a("./swfobject"),f=a("./msgtool"),g={};g.SMS_DOMAIN="localhost",g.SMS_TYPE_ID={0:{title:"个人消息",id:"sms"},"-1":{title:"拍卖通知",id:"auction"},"-2":{title:"财务通知",id:"finance"},"-3":{title:"交易通知",id:"trade"},"-4":{title:"鉴定通知",id:"jianding"},"-5":{title:"其他通知",id:"bbs"},"-127":{title:"其他通知",id:"bbs"}},g.SMS_TYPE={sms:0,auction:-1,finance:-2,trade:-3,jianding:-4,bbs:-5},g.ModelBase=function(a){this._initModelBase(a),this.unloadGoodsInfo=[]},g.ModelBase.prototype={_initModelBase:function(a){this.options=mix({"default":{}},a),this.attributes=mix({},this.options["default"]),EventEmitter.call(this)},set:function(a,b){this.attributes[a]=b,this.emit("change:"+a,{model:this,value:b})},get:function(a){return this.attributes[a]}},extend(g.ModelBase,EventEmitter),g.MsgModel=function(a){this._initMsgModel(a)},g.MsgModel.prototype={_initMsgModel:function(a){g.ModelBase.call(this,a),this.options=mix({"default":{currentPointer:0}},a),this.chatSessions={},this.chatSessionsArray=[]},sessionExist:function(a){return!!this.chatSessions[a]},getSessionLength:function(){return this.chatSessionsArray.length},addSession:function(a){if(a.sessionId)this.chatSessions[a.sessionId]=a,this.chatSessionsArray.push(a.sessionId),this.emit("session:add",{sessionsArray:this.chatSessionsArray,sessions:this.chatSessions,session:a}),this.readMessageHistory(a);else{this.readMessageHistory(a,function(b){a.sessionId=b.sessionId,this.chatSessions[a.sessionId]=a,this.chatSessionsArray.push(a.sessionId),this.emit("session:add",{sessionsArray:this.chatSessionsArray,sessions:this.chatSessions,session:a})})}},removeSession:function(a){delete this.chatSessions[a];var b=indexOf(this.chatSessionsArray,a);this.chatSessionsArray.splice(b,1),this.emit("session:delete",{sessionsArray:this.chatSessionsArray,sessions:this.chatSessions})},removeSessionByOrder:function(a){var b=this.chatSessionsArray[a];delete this.chatSessions[b],this.chatSessionsArray.splice(a,1),this.emit("session:delete",{sessionsArray:this.chatSessionsArray,sessions:this.chatSessions})},getSession:function(a){return this.chatSessions[this.chatSessionsArray[a]]},getCurrentSession:function(){var a=this.get("currentPointer");return this.getSession(void 0!==a&&a>=0&&a<this.chatSessionsArray.length?a:this.chatSessionsArray.length-1)},readMessageHistory:function(a,b){var c=this;$.ajax({dataType:"jsonp",url:"http://member.sssc.cn/message/ajax-get-msg?session_id=&page=1&begin_id=0&receiverIds="+a.senderUid+"&7658615395172941&callback=?",method:"get",success:function(d){b&&b(d);for(var e=0,f=d.datas.length;f>e;e++){var g=c.analyzeUrl(d.datas[e].message);g&&(d.datas[e].linkinfo=g)}c.emit("load:message",{messages:d,userInfo:a})},error:function(){}})},analyzeUrl:function(a){var b=/pai\.sssc\.cn\/(item)\/(\d+)/i,c=/bbs.sssc.cn\/thread-(\d+)-/i,d=b.exec(a),e=c.exec(a),f=null;if(d&&(f={type:d[1],id:d[2]}),e&&(f={type:"tid",id:e[1]}),f){var g="li_"+Math.random().toString().replace(".",""),h={uuid:g,type:f.type,id:f.id};return this.unloadGoodsInfo.push(h),h}return!1},loadGoodsInfo:function(){for(;this.unloadGoodsInfo.length>0;)this.loadPerGoodInfo(this.unloadGoodsInfo.pop())},loadPerGoodInfo:function(a){var b=this,c="http://member.sssc.cn/message/get-link-info?type="+a.type+"&id="+a.id+"&callback=?";$.ajax({dataType:"jsonp",url:c,success:function(c){b.emit("load:goodsinfo",{info:a,data:c})}})},setMessage:function(a,b){if("sms"==a){for(var c=[],d=0,e={},f=0,g=b.length;g>f;f++)this.sessionExist(b[f].sessionId)?(e[b[f].sessionId]||(e[b[f].sessionId]=[]),e[b[f].sessionId].push(b[f]),this.set("lastMessageId_"+b[f].sessionId,b[f].id),d++):c.push(b[f]);this.emit("chat:message",{model:this,messages:e,sessionsArray:this.chatSessionsArray}),this.set("sms",c),this.set("totalCount",this.get("totalCount")-d)}else this.set(a,b)},sendMessage:function(a){var b=this,c=this.getCurrentSession();if(!c)return void console.log("undefined chat user");var d="http://member.sssc.cn/message/ajax-send-msg?receiverName="+c.senderName+"&receivers="+c.senderUid+"&session_id="+c.sessionId+"&text="+encodeURIComponent(a.text)+"&callback=?";void 0!==a.image&&""!=a.image&&(d+="&uploadedFiles[0]="+a.image),$.ajax({dataType:"jsonp",method:"get",url:d,success:function(a){if(b.emit("sendcomplete:message",{model:this}),!a.success)return void alert(a.message);var d="";a.images.length>0&&(d=a.images[0].thumb.replace("http://img.scimg.cn/userupload/messageimages/80x80/",""));var e={senderUid:b.get("uid"),senderName:"我",text:a.text,images:d,sendTime:a.createdTime,id:a.messageId};b.set("lastMessageId_"+c.sessionId,a.messageId);var f={};f[c.sessionId]=[e],b.emit("chat:message",{model:b,messages:f,sessionsArray:b.chatSessionsArray})},error:function(){}})},clearAll:function(){},clearTarget:function(){},clearSession:function(a){$.get("http://"+g.SMS_DOMAIN+"/n/clear?t="+Math.random()+"&sid="+a,function(){},"script")}},extend(g.MsgModel,g.ModelBase),g.MsgStatusModel=function(){},g.MsgStatusModel.prototype={},g.UIBase=function(a){this._initUIBase(a)},g.UIBase.prototype={_initUIBase:function(a){this.options=mix({},a),this.model=this.options.model,EventEmitter.call(this)},initUI:function(){}},extend(g.UIBase,EventEmitter),g.MsgBar=function(a){this._initMsgBar(a)},g.MsgBar.prototype={_initMsgBar:function(a){g.UIBase.call(this,mix({swfurl:"new-msg.swf?"},a)),this.initUI(),this.panel=$(this.bar),this.initEvents()},initUI:function(){var a=this.bar=$c("div",null,"msg-bar msgonpage"),b=this.bub=$c("div",null,"bub total");b.innerHTML="<i></i>";var c=this.bubNumber=$c("span");b.appendChild(c),c.innerHTML="0";var d=this.barItems=$c("ul",null,"bar_items"),e=this.toggle=$c("div",null,"toggle");a.appendChild(b),a.appendChild(d),a.appendChild(e);var f=this.flashContainer=$c("div","flashcontainer");f.style.cssText="width: 5px; height: 5px; bottom: -10px; position: absolute;",a.appendChild(f),this.addFlash()},initEvents:function(){var a=this;$(this.toggle).click(function(){$(a.barItems).toggle(),$(a.bub).toggle(),$(this).toggleClass("col")}),this.options.model.on("change:totalCount",function(b){a.setCount(b.value)})},open:function(){},close:function(){},setCount:function(a){var b=a;a>99&&(b="99+"),this.bubNumber.innerHTML=b},getDom:function(){return this.bar},addStatus:function(a){this.barItems.appendChild(a.getDom())},addFlash:function(){e.embedSWF(this.options.swfurl,"flashcontainer","1","1","10")}},extend(g.MsgBar,g.UIBase),g.MsgStatus=function(a){this._initMsgStatus(a)},g.MsgStatus.prototype={_initMsgStatus:function(a){g.UIBase.call(this,mix({iconId:1,title:"",smsType:"",clearNotice:"",checkInbox:""},a)),this.templateHMLT=document.getElementById("tmpl_popwin").innerHTML,this.smslistTmpl=new d(document.getElementById("tmpl_popwin_msg").innerHTML),this.active=!1,this.initUI(),this.panel=$(this.barItem),this.initEvents(),this.updateList([])},initUI:function(){var a=this.barItem=$c("li",null,"i-"+this.options.iconId+" bar_item"),b=this.barBtn=$c("a",null,"btn_bar"),c=this.bub=$c("div",null,"bub");c.innerHTML="<i></i>";var e=this.bubNumber=$c("span");c.appendChild(e);var f=this.popwin=$c("div",null,"popwin");b.appendChild(c),a.appendChild(b),a.appendChild(f);var g=new d(this.templateHMLT);f.innerHTML=g.render({title:this.options.title,clearNotice:this.options.clearNotice,checkInbox:this.options.checkInbox})},initEvents:function(){var a=this;$(this.barItem).click(function(){a.openBox()}),$(document).click(function(b){b.target==a.popwin||$.contains(a.popwin,b.target)||b.target==a.barBtn||$.contains(a.barBtn,b.target)||a.active&&a.closeBox()}),this.panel.delegate(".ignore-ajax","click",function(b){b.preventDefault(),a.updateList([]),a.showAdView();var c=this.href;a.emit("ignore",{});try{$.ajax({type:"get",dataType:"script",url:c+"&t="+Math.random(),success:function(){},error:function(){}}),/type=-5/.test(c)&&$.ajax({type:"get",dataType:"script",url:c.replace("-5","-127")+"&t="+Math.random(),success:function(){},error:function(){}})}catch(d){}}),this.panel.delegate(".msg_txt","click",function(b){if("0"==this.getAttribute("type")){var c=this.getAttribute("sessionid"),d=this.getAttribute("senduid"),e=this.getAttribute("sendname"),f=this.getAttribute("url"),g={sessionId:c,senderUid:d,senderName:e,referLink:f},h=a.options.model;if(h.sessionExist(c))return void alert("已存在会话,无法添加");if(h.getSessionLength()>=3)return void alert("聊天人数已达到上限");a.options.model.addSession(g),a.options.model.clearSession(c);var i=a.panel.find('.sms_list li[sessionid="'+c+'"]').length;a.panel.find('.sms_list li[sessionid="'+c+'"]').remove(),a.setCount(a.panel.find(".sms_list>li").length),a.options.model.set("totalCount",a.options.model.get("totalCount")-i)}else window.open(this.getAttribute("url"));b.preventDefault(),b.stopPropagation()}),this.options.model.on("change:"+this.options.type,function(b){a.updateList(b.value)})},showAdView:function(){},hideAdView:function(){},openBox:function(){$(this.popwin).show(),$(this.barBtn).addClass("highlight"),this.active=!0},closeBox:function(){$(this.popwin).hide(),$(this.barBtn).removeClass("highlight"),this.active=!1},setCount:function(a){this.bubNumber.innerHTML=a>99?"99+":a,a>0?($(this.bub).show(),this.activeBtn()):($(this.bub).hide(),this.disactiveBtn(),this.hideAdView())},activeBtn:function(){$(this.barBtn).addClass("active")},disactiveBtn:function(){$(this.barBtn).removeClass("active")},updateList:function(a){for(var b=0,c=a.length;c>b;b++)a[b].senderName||(a[b].senderName="系统"),a[b].text=f.showFace(f.showBold(a[b].text));this.setCount(a.length),this.panel.find(".sms_list").html(this.smslistTmpl.render({checkInbox:this.options.checkInbox,messages:a}))},clearTarget:function(){},clearAll:function(){},getDom:function(){return this.barItem}},extend(g.MsgStatus,g.UIBase),g.MsgUI=function(a){this._initMsgUI(a)},g.MsgUI.prototype={_initMsgUI:function(a){this.options=mix({iframeurl:"smscomet.html",model:null},a),this.origTitle=document.title,this.msgBar=new g.MsgBar({model:this.options.model}),this.status={},this.status.sms=new g.MsgStatus({type:"sms",title:"个人信息",iconId:1,model:this.options.model}),this.status.finance=new g.MsgStatus({type:"finance",title:"财务通知",iconId:2,model:this.options.model}),this.status.auction=new g.MsgStatus({type:"auction",title:"拍卖通知",iconId:3,model:this.options.model}),this.status.trade=new g.MsgStatus({type:"trade",title:"交易通知",iconId:4,model:this.options.model}),this.status.bbs=new g.MsgStatus({type:"bbs",title:"其他通知",iconId:5,model:this.options.model}),this.status.jianding=new g.MsgStatus({type:"jianding",title:"鉴定通知",iconId:6,model:this.options.model});for(var b in this.status)this.msgBar.addStatus(this.status[b]);document.body.appendChild(this.msgBar.getDom()),this.chatbox=new g.ChatBox({fnBarTemplate:document.getElementById("tmpl_fn_bar").innerHTML,model:this.options.model}),document.body.appendChild(this.chatbox.getDom()),this.addIfrmae()},setScsms:function(){},addIfrmae:function(){try{var a=this,b=document.createElement("iframe"),c=!1;b.onload=function(){if(!c){c=!0;var d=b.contentWindow;d.scsms.regist(a),a.setScsms(d.scsms)}},b.onreadystatechange=function(){if("complete"==this.readyState){if(c)return;c=!0;var d=b.contentWindow;d.scsms.regist(a),a.setScsms(d.scsms)}},b.charset="utf-8",b.src=this.options.iframeurl,b.width=1,b.height=1,b.style.position="absolute",b.style.left="-100px",b.style.top="-100px",document.body.appendChild(b)}catch(d){}},notify:function(a,b){this.msgBar.setCount(b);for(var c in a)this.options.model.setMessage(c,a[c]),this.options.model.set("totalCount",b)},playSound:function(){try{{document.getElementById("flashcontainer")}}catch(a){}},updatePageTitle:function(a){document.title=1>a?this.origTitle:"("+a+")"+this.origTitle}},g.ChatBox=function(a){this._initChatBox(a)},g.ChatBox.prototype={_initChatBox:function(a){g.UIBase.call(this,mix({fnBarTemplate:"",faces:[["强","[/qiang]","qiang.gif"],["弱","[/ruo]","ruo.gif"],["握手","[/ws]","ws.gif"],["胜利","[/shl]","shl.gif"],["抱拳","[/bq]","bq.gif"],["勾引","[/gy]","gy.gif"],["拳头","[/qt]","qt.gif"],["差劲","[/cj]","cj.gif"],["爱你","[/aini]","aini.gif"],["NO","[/bu]","bu.gif"],["YES","[/hd]","hd.gif"],["微笑","[/wx]","wx.gif"],["撇嘴","[/pz]","pz.gif"],["色","[/se]","se.gif"],["发呆","[/fd]","fd.gif"],["得意","[/dy]","dy.gif"],["流泪","[/ll]","ll.gif"],["害羞","[/hx]","hx.gif"],["闭嘴","[/bz]","bz.gif"],["睡","[/shui]","shui.gif"],["大哭","[/dk]","dk.gif"],["尴尬","[/gg]","gg.gif"],["发怒","[/fn]","fn.gif"],["调皮","[/tp]","tp.gif"],["呲牙","[/cy]","cy.gif"],["惊讶","[/jy]","jy.gif"],["难过","[/ng]","ng.gif"],["酷酷","[/kuk]","kuk.gif"],["冷汗","[/lengh]","lengh.gif"],["抓狂","[/zk]","zk.gif"],["吐","[/tuu]","tuu.gif"],["偷笑","[/tx]","tx.gif"],["可爱","[/ka]","ka.gif"],["白眼","[/baiy]","baiy.gif"],["傲慢","[/am]","am.gif"],["饥饿","[/jie]","jie.gif"],["困","[/kun]","kun.gif"],["惊恐","[/jk]","jk.gif"],["流汗","[/lh]","lh.gif"],["憨笑","[/hanx]","hanx.gif"],["大兵","[/db]","db.gif"],["奋斗","[/fendou]","fendou.gif"],["咒骂","[/zhm]","zhm.gif"],["疑问","[/yiw]","yiw.gif"],["嘘","[/xu]","xu.gif"],["晕","[/yun]","yun.gif"],["折磨","[/zhem]","zhem.gif"],["衰","[/shuai]","shuai.gif"],["骷髅","[/kl]","kl.gif"],["敲","[/qiao]","qiao.gif"],["再见","[/zj]","zj.gif"],["擦汗","[/ch]","ch.gif"],["抠鼻","[/kb]","kb.gif"],["鼓掌","[/gz]","gz.gif"],["糗大了","[/qd]","qd.gif"],["坏笑","[/huaix]","huaix.gif"],["左哼哼","[/zhh]","zhh.gif"],["右哼哼","[/yhh]","yhh.gif"],["哈欠","[/hq]","hq.gif"],["鄙视","[/bs]","bs.gif"],["委屈","[/wq]","wq.gif"],["快哭了","[/kk]","kk.gif"],["阴险","[/yx]","yx.gif"],["亲亲","[/qq]","qq.gif"],["吓","[/xia]","xia.gif"],["可怜","[/kel]","kel.gif"],["菜刀","[/cd]","cd.gif"],["刀","[/dao]","dao.gif"],["玫瑰","[/mg]","mg.gif"],["凋谢","[/dx]","dx.gif"],["西瓜","[/xig]","xig.gif"],["啤酒","[/pj]","pj.gif"],["蛋糕","[/dg]","dg.gif"],["咖啡","[/kf]","kf.gif"],["饭","[/fan]","fan.gif"],["示爱","[/sa]","sa.gif"],["心","[/xin]","xin.gif"],["心碎","[/xs]","xs.gif"],["闪电","[/shd]","shd.gif"],["炸弹","[/zhd]","zhd.gif"],["猪头","[/zt]","zt.gif"],["瓢虫","[/pch]","pch.gif"],["便便","[/bb]","bb.gif"],["太阳","[/ty]","ty.gif"],["月亮","[/yl]","yl.gif"],["礼物","[/lw]","lw.gif"],["拥抱","[/yb]","yb.gif"],["足球","[/zq]","zq.gif"],["篮球","[/lq]","lq.gif"],["乒乓","[/pp]","pp.gif"]],model:null},a)),this.initUI(),this.persons=[],this.panel=$(this.chatBox),this.sessions={},this.chattab=new g.SimpleTab({container:this.chatBox,tab:".footer ul li",content:".content>ul",selectClass:"active"}),new g.SimpleTab({container:$(this.chatBox).find(".pop.smile"),tab:".tab a",content:"ul li",selectClass:"active"}),this.initEvents()},initUI:function(){var a=this.chatBox=$c("div",null,"chatbox msgonpage"),b=$c("div",null,"title"),c=document.createTextNode("正在与"),e=document.createTextNode("聊天"),f=this.targetPer=$c("span"),g=this.btnClose=$c("a",null,"btn_close");b.appendChild(c),b.appendChild(f),b.appendChild(e),b.appendChild(g);var h=this.content=$c("div",null,"content"),i=$c("div",null,"fn_bar"),j=new d(this.options.fnBarTemplate);
i.innerHTML=j.render({faces:this.options.faces});var k=$c("div",null,"msgbox"),l=this.msgTextarea=$c("textarea",null,"msg-content");k.appendChild(l);var m=$c("div",null,"footer"),n=this.toUserList=$c("ul"),o=this.btnSend=$c("div",null,"btn_send");o.innerHTML="发送",m.appendChild(n),m.appendChild(o),a.appendChild(b),a.appendChild(h),a.appendChild(i),a.appendChild(k),a.appendChild(m)},initEvents:function(){var a=this;a.lastPop=null,this.panel.find(".fn_bar .btnbox .ico.phrase").click(function(){a.lastPop!=this&&a.lastPop&&($(a.lastPop.parentNode).find(".pop").hide(),$(a.lastPop).removeClass("active")),$(this.parentNode).find(".pop").toggle(),$(this).toggleClass("active"),a.lastPop=this}),this.panel.find(".fn_bar .btnbox .ico.smile").click(function(){a.lastPop!=this&&a.lastPop&&($(a.lastPop.parentNode).find(".pop").hide(),$(a.lastPop).removeClass("active")),$(this.parentNode).find(".pop").toggle(),$(this).toggleClass("active"),a.lastPop=this}),this.panel.find(".fn_bar .btnbox.uploadimg").hover(function(){0!=$(this).find(".pop input").length&&$(this).find(".pop").show()},function(){$(this).find(".pop").hide()}),this.panel.find(".fn_bar .btnbox .pop.smile").delegate("ul span a","click",function(b){a.addText(this.hash.substr(1)),a.panel.find(".fn_bar .btnbox .pop.smile").hide(),a.panel.find(".fn_bar .btnbox .ico.smile").removeClass("active"),b.preventDefault()}),this.panel.find(".fn_bar .btnbox .pop.phrase").delegate("li","click",function(){a.addText(this.innerHTML),a.panel.find(".fn_bar .btnbox .pop.phrase").hide(),a.panel.find(".fn_bar .btnbox .ico.phrase").removeClass("active")}),this.panel.find(".fn_bar .btnbox .ico.uploadimg").click(function(){var a=this;if(this.fileUploadStatus)return void openFileUploader();console.log("upload img");var b="1.1";jQuery("head").append('<link rel="stylesheet" href="http://img.scimg.cn/styles/jquery-ui/jquery-ui.css" type="text/css" media="all" />'),"undefined"==typeof jQuery.fn.ajaxSubmit&&jQuery(document).append('<script type="text/javascript" src="http://img.scimg.cn/javascripts/member/jquery.form-2.40.js?'+b+'" charset="utf-8"></script>'),$.getScript("http://img.scimg.cn/javascripts/jquery/jquery-ui.js",function(){$.ajax({dataType:"script",type:"get",url:"js/file-uploader.js",success:function(){a.fileUploadStatus=!0,console.log("load script"),openFileUploader()}})})}),$(this.btnSend).click(function(){var b=$.trim(a.msgTextarea.value);""==b&&alert("回复内容不能为空");var c=a.panel.find(".pop.uploadimg input").val();a.model.sendMessage({text:b,image:c}),console.log(a.model.getCurrentSession())}),$(this.toUserList).delegate("li i.ico.close","click",function(){var b=this.parentNode.tabindex;$(a.content).find(">ul").eq(b).remove(),$(this.parentNode).remove(),a.chattab.buildTabStatus(),a.options.model.removeSessionByOrder(b),0==a.options.model.getSessionLength()&&a.hide()}),this.chattab.on("show",function(b){a.setTitle(a.persons[b.index].senderName),a.model.set("currentPointer",b.index)}),this.model.on("session:add",function(b){1==a.options.model.getSessionLength()&&a.show(),a.addChatPerson(b.session)}),this.model.on("load:message",function(b){var c=b.messages.sessionId;a.sessions[c].list.innerHTML="加载完成";var e=new d(document.getElementById("tmpl_chat_item").innerHTML);a.sessions[c].list.innerHTML=e.render({messages:b.messages.datas,uid:a.model.get("uid"),process:function(a){return f.showBoldAndUrl(f.showFace(a))}}),a.model.set("lastMessageId_"+c,b.messages.datas[b.messages.datas.length-1].id),a.scrollToBottom(),a.model.loadGoodsInfo()}),this.model.on("chat:message",function(b){var c=new d(document.getElementById("tmpl_chat_item_per").innerHTML);for(var e in b.messages){a.sessions[e].list.innerHTML+=c.render({messages:b.messages[e],uid:a.model.get("uid"),process:function(a){return f.showBoldAndUrl(f.showFace(a))}}),a.scrollToBottom();{indexOf(b.sessionsArray,e)}$(a.sessions[e].tab).hasClass("active")||$(a.sessions[e].tab).addClass("highlight")}}),this.model.on("load:goodsinfo",function(a){var b=new d(document.getElementById("tmpl_goods").innerHTML);console.log(a),$("#"+a.info.uuid).html(b.render(a.data))}),this.model.on("sendcomplete:message",function(){a.msgTextarea.value="",a.panel.find(".pop.uploadimg").html("")}),$(this.btnClose).click(function(){a.hide()})},scrollToBottom:function(){this.content.scrollTop=this.content.scrollHeight},addChatPerson:function(a){this.persons.push(a);var b=$c("li",null,"");b.sessionid=a.sessionId,b.innerHTML="<span>"+a.senderName+'</span><i class="ico close">x</i>',this.toUserList.appendChild(b);var c=$c("ul");c.innerHTML="消息记录读取中...",this.content.appendChild(c),this.chattab.buildTabStatus(),this.sessions[a.sessionId]={list:c,tab:b}},setTitle:function(a){this.targetPer.innerHTML=a},addText:function(a){this.msgTextarea.value+=a,this.msgTextarea.focus()},show:function(){$(this.chatBox).show()},hide:function(){$(this.chatBox).hide()},getDom:function(){return this.chatBox}},extend(g.ChatBox,g.UIBase),g.SimpleTab=function(a){this._initSimpleTab(a)},g.SimpleTab.prototype={_initSimpleTab:function(a){EventEmitter.call(this),this.options=mix({container:"",tab:"",content:"",fireevent:"click",selectClass:"select"},a),this.selectedIndex=0,this.total=0,this.panel=$(this.options.container),this.buildTabStatus(),this.initUI(),this.initEvents()},initUI:function(){this.show(0)},buildTabStatus:function(){var a=this;this.total=0,this.panel.find(this.options.tab).each(function(b){this.tabindex=b,a.total++}),this.panel.find(this.options.content).hide(),this.total>0&&this.show(this.total-1)},initEvents:function(){var a=this;this.panel.delegate(this.options.tab,this.options.fireevent,function(){var b=this.tabindex;$(this).removeClass("highlight"),a.emit("tabselect",{index:b}),a.show(b)})},show:function(a){var b=this.options;this.panel.find(b.tab+":eq("+this.selectedIndex+")").removeClass(b.selectClass),this.panel.find(b.tab+":eq("+a+")").addClass(b.selectClass),this.panel.find(b.content+":eq("+this.selectedIndex+")").hide(),this.panel.find(b.content+":eq("+a+")").show();var c={prevIndex:this.selectedIndex,index:a};this.selectedIndex=a,this.emit("show",c)}},extend(g.SimpleTab,EventEmitter),c.exports=g});